[{"type":"js","data":"//////////////////////////////////////////////////////////////////////////\n//                                                                      //\n// This is a generated file. You can view the original                  //\n// source in your browser if your browser supports source maps.         //\n// Source maps are supported by all recent versions of Chrome, Safari,  //\n// and Firefox, and by Internet Explorer 11.                            //\n//                                                                      //\n//////////////////////////////////////////////////////////////////////////\n\n\n(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar Tracker = Package.tracker.Tracker;\nvar Deps = Package.tracker.Deps;\nvar meteorInstall = Package.modules.meteorInstall;\nvar Promise = Package.promise.Promise;\n\nvar require = meteorInstall({\"node_modules\":{\"meteor\":{\"react-meteor-data\":{\"index.js\":function module(require,exports,module){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                              //\n// packages/react-meteor-data/index.js                                                                          //\n//                                                                                                              //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                //\nlet React;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  }\n}, 0);\nmodule.link(\"./useTracker\", {\n  useTracker: \"useTracker\"\n}, 1);\nmodule.link(\"./withTracker.tsx\", {\n  withTracker: \"withTracker\"\n}, 2);\nmodule.link(\"./useFind\", {\n  useFind: \"useFind\"\n}, 3);\nmodule.link(\"./useSubscribe\", {\n  useSubscribe: \"useSubscribe\"\n}, 4);\nif (Meteor.isDevelopment) {\n  const v = React.version.split('.');\n  if (v[0] < 16 || v[0] == 16 && v[1] < 8) {\n    console.warn('react-meteor-data 2.x requires React version >= 16.8.');\n  }\n}\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"useFind.ts\":function module(require,exports,module){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                              //\n// packages/react-meteor-data/useFind.ts                                                                        //\n//                                                                                                              //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                //\nmodule.export({\n  useFind: () => useFind\n});\nlet Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor(v) {\n    Meteor = v;\n  }\n}, 0);\nlet Mongo;\nmodule.link(\"meteor/mongo\", {\n  Mongo(v) {\n    Mongo = v;\n  }\n}, 1);\nlet useReducer, useMemo, useEffect, useRef;\nmodule.link(\"react\", {\n  useReducer(v) {\n    useReducer = v;\n  },\n  useMemo(v) {\n    useMemo = v;\n  },\n  useEffect(v) {\n    useEffect = v;\n  },\n  useRef(v) {\n    useRef = v;\n  }\n}, 2);\nlet Tracker;\nmodule.link(\"meteor/tracker\", {\n  Tracker(v) {\n    Tracker = v;\n  }\n}, 3);\nconst useFindReducer = (data, action) => {\n  switch (action.type) {\n    case 'refresh':\n      return action.data;\n    case 'addedAt':\n      return [...data.slice(0, action.atIndex), action.document, ...data.slice(action.atIndex)];\n    case 'changedAt':\n      return [...data.slice(0, action.atIndex), action.document, ...data.slice(action.atIndex + 1)];\n    case 'removedAt':\n      return [...data.slice(0, action.atIndex), ...data.slice(action.atIndex + 1)];\n    case 'movedTo':\n      const doc = data[action.fromIndex];\n      const copy = [...data.slice(0, action.fromIndex), ...data.slice(action.fromIndex + 1)];\n      copy.splice(action.toIndex, 0, doc);\n      return copy;\n  }\n};\n// Check for valid Cursor or null.\n// On client, we should have a Mongo.Cursor (defined in\n// https://github.com/meteor/meteor/blob/devel/packages/minimongo/cursor.js and\n// https://github.com/meteor/meteor/blob/devel/packages/mongo/collection.js).\n// On server, however, we instead get a private Cursor type from\n// https://github.com/meteor/meteor/blob/devel/packages/mongo/mongo_driver.js\n// which has fields _mongo and _cursorDescription.\nconst checkCursor = cursor => {\n  if (cursor !== null && cursor !== undefined && !(cursor instanceof Mongo.Cursor) && !(cursor._mongo && cursor._cursorDescription)) {\n    console.warn('Warning: useFind requires an instance of Mongo.Cursor. ' + 'Make sure you do NOT call .fetch() on your cursor.');\n  }\n};\n// Synchronous data fetch. It uses cursor observing instead of cursor.fetch() because synchronous fetch will be deprecated.\nconst fetchData = cursor => {\n  const data = [];\n  const observer = cursor.observe({\n    addedAt(document, atIndex, before) {\n      data.splice(atIndex, 0, document);\n    }\n  });\n  observer.stop();\n  return data;\n};\nconst useFindClient = function (factory) {\n  let deps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  const cursor = useMemo(() => {\n    // To avoid creating side effects in render, opt out\n    // of Tracker integration altogether.\n    const cursor = Tracker.nonreactive(factory);\n    if (Meteor.isDevelopment) {\n      checkCursor(cursor);\n    }\n    return cursor;\n  }, deps);\n  const [data, dispatch] = useReducer(useFindReducer, null, () => {\n    if (!(cursor instanceof Mongo.Cursor)) {\n      return [];\n    }\n    return fetchData(cursor);\n  });\n  // Store information about mounting the component.\n  // It will be used to run code only if the component is updated.\n  const didMount = useRef(false);\n  useEffect(() => {\n    // Fetch intitial data if cursor was changed.\n    if (didMount.current) {\n      if (!(cursor instanceof Mongo.Cursor)) {\n        return;\n      }\n      const data = fetchData(cursor);\n      dispatch({\n        type: 'refresh',\n        data\n      });\n    } else {\n      didMount.current = true;\n    }\n    if (!(cursor instanceof Mongo.Cursor)) {\n      return;\n    }\n    const observer = cursor.observe({\n      addedAt(document, atIndex, before) {\n        dispatch({\n          type: 'addedAt',\n          document,\n          atIndex\n        });\n      },\n      changedAt(newDocument, oldDocument, atIndex) {\n        dispatch({\n          type: 'changedAt',\n          document: newDocument,\n          atIndex\n        });\n      },\n      removedAt(oldDocument, atIndex) {\n        dispatch({\n          type: 'removedAt',\n          atIndex\n        });\n      },\n      movedTo(document, fromIndex, toIndex, before) {\n        dispatch({\n          type: 'movedTo',\n          fromIndex,\n          toIndex\n        });\n      },\n      // @ts-ignore\n      _suppress_initial: true\n    });\n    return () => {\n      observer.stop();\n    };\n  }, [cursor]);\n  return cursor ? data : cursor;\n};\nconst useFindServer = (factory, deps) => Tracker.nonreactive(() => {\n  var _cursor$fetch, _cursor$fetch2;\n  const cursor = factory();\n  if (Meteor.isDevelopment) checkCursor(cursor);\n  return (_cursor$fetch = cursor === null || cursor === void 0 ? void 0 : (_cursor$fetch2 = cursor.fetch) === null || _cursor$fetch2 === void 0 ? void 0 : _cursor$fetch2.call(cursor)) !== null && _cursor$fetch !== void 0 ? _cursor$fetch : null;\n});\nconst useFind = Meteor.isServer ? useFindServer : useFindClient;\nfunction useFindDev(factory) {\n  let deps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  function warn(expects, pos, arg, type) {\n    console.warn(\"Warning: useFind expected a \".concat(expects, \" in it's \").concat(pos, \" argument \") + \"(\".concat(arg, \"), but got type of `\").concat(type, \"`.\"));\n  }\n  if (typeof factory !== 'function') {\n    warn(\"function\", \"1st\", \"reactiveFn\", factory);\n  }\n  if (!deps || !Array.isArray(deps)) {\n    warn(\"array\", \"2nd\", \"deps\", typeof deps);\n  }\n  return useFind(factory, deps);\n}\nmodule.exportDefault(Meteor.isDevelopment ? useFindDev : useFind);\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"useSubscribe.ts\":function module(require,exports,module){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                              //\n// packages/react-meteor-data/useSubscribe.ts                                                                   //\n//                                                                                                              //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                //\nmodule.export({\n  useSubscribe: () => useSubscribe\n});\nlet Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor(v) {\n    Meteor = v;\n  }\n}, 0);\nlet useTracker;\nmodule.link(\"./useTracker\", {\n  useTracker(v) {\n    useTracker = v;\n  }\n}, 1);\nconst useSubscribeClient = function (name) {\n  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n  let updateOnReady = false;\n  let subscription;\n  const isReady = useTracker(() => {\n    if (!name) return true;\n    subscription = Meteor.subscribe(name, ...args);\n    return subscription.ready();\n  }, () => !updateOnReady);\n  return () => {\n    updateOnReady = true;\n    return !isReady;\n  };\n};\nconst useSubscribeServer = function (name) {\n  return () => false;\n};\nconst useSubscribe = Meteor.isServer ? useSubscribeServer : useSubscribeClient;\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"useTracker.ts\":function module(require,exports,module){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                              //\n// packages/react-meteor-data/useTracker.ts                                                                     //\n//                                                                                                              //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                //\nmodule.export({\n  useTracker: () => useTracker\n});\nlet Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor(v) {\n    Meteor = v;\n  }\n}, 0);\nlet Tracker;\nmodule.link(\"meteor/tracker\", {\n  Tracker(v) {\n    Tracker = v;\n  }\n}, 1);\nlet useReducer, useEffect, useRef, useMemo;\nmodule.link(\"react\", {\n  useReducer(v) {\n    useReducer = v;\n  },\n  useEffect(v) {\n    useEffect = v;\n  },\n  useRef(v) {\n    useRef = v;\n  },\n  useMemo(v) {\n    useMemo = v;\n  }\n}, 2);\n// Warns if data is a Mongo.Cursor or a POJO containing a Mongo.Cursor.\nfunction checkCursor(data) {\n  let shouldWarn = false;\n  if (Package.mongo && Package.mongo.Mongo && data && typeof data === 'object') {\n    if (data instanceof Package.mongo.Mongo.Cursor) {\n      shouldWarn = true;\n    } else if (Object.getPrototypeOf(data) === Object.prototype) {\n      Object.keys(data).forEach(key => {\n        if (data[key] instanceof Package.mongo.Mongo.Cursor) {\n          shouldWarn = true;\n        }\n      });\n    }\n  }\n  if (shouldWarn) {\n    console.warn('Warning: your reactive function is returning a Mongo cursor. ' + 'This value will not be reactive. You probably want to call ' + '`.fetch()` on the cursor before returning it.');\n  }\n}\n// Used to create a forceUpdate from useReducer. Forces update by\n// incrementing a number whenever the dispatch method is invoked.\nconst fur = x => x + 1;\nconst useForceUpdate = () => useReducer(fur, 0)[1];\nconst useTrackerNoDeps = function (reactiveFn) {\n  let skipUpdate = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  const {\n    current: refs\n  } = useRef({\n    isMounted: false,\n    trackerData: null\n  });\n  const forceUpdate = useForceUpdate();\n  // Without deps, always dispose and recreate the computation with every render.\n  if (refs.computation) {\n    refs.computation.stop();\n    // @ts-ignore This makes TS think ref.computation is \"never\" set\n    delete refs.computation;\n  }\n  // Use Tracker.nonreactive in case we are inside a Tracker Computation.\n  // This can happen if someone calls `ReactDOM.render` inside a Computation.\n  // In that case, we want to opt out of the normal behavior of nested\n  // Computations, where if the outer one is invalidated or stopped,\n  // it stops the inner one.\n  Tracker.nonreactive(() => Tracker.autorun(c => {\n    refs.computation = c;\n    const data = reactiveFn(c);\n    if (c.firstRun) {\n      // Always run the reactiveFn on firstRun\n      refs.trackerData = data;\n    } else if (!skipUpdate || !skipUpdate(refs.trackerData, data)) {\n      // For any reactive change, forceUpdate and let the next render rebuild the computation.\n      forceUpdate();\n    }\n  }));\n  // To clean up side effects in render, stop the computation immediately\n  if (!refs.isMounted) {\n    Meteor.defer(() => {\n      if (!refs.isMounted && refs.computation) {\n        refs.computation.stop();\n        delete refs.computation;\n      }\n    });\n  }\n  useEffect(() => {\n    // Let subsequent renders know we are mounted (render is committed).\n    refs.isMounted = true;\n    // In some cases, the useEffect hook will run before Meteor.defer, such as\n    // when React.lazy is used. In those cases, we might as well leave the\n    // computation alone!\n    if (!refs.computation) {\n      // Render is committed, but we no longer have a computation. Invoke\n      // forceUpdate and let the next render recreate the computation.\n      if (!skipUpdate) {\n        forceUpdate();\n      } else {\n        Tracker.nonreactive(() => Tracker.autorun(c => {\n          const data = reactiveFn(c);\n          refs.computation = c;\n          if (!skipUpdate(refs.trackerData, data)) {\n            // For any reactive change, forceUpdate and let the next render rebuild the computation.\n            forceUpdate();\n          }\n        }));\n      }\n    }\n    // stop the computation on unmount\n    return () => {\n      var _refs$computation;\n      (_refs$computation = refs.computation) === null || _refs$computation === void 0 ? void 0 : _refs$computation.stop();\n      delete refs.computation;\n      refs.isMounted = false;\n    };\n  }, []);\n  return refs.trackerData;\n};\nconst useTrackerWithDeps = function (reactiveFn, deps) {\n  let skipUpdate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  const forceUpdate = useForceUpdate();\n  const {\n    current: refs\n  } = useRef({\n    reactiveFn\n  });\n  // keep reactiveFn ref fresh\n  refs.reactiveFn = reactiveFn;\n  useMemo(() => {\n    // To jive with the lifecycle interplay between Tracker/Subscribe, run the\n    // reactive function in a computation, then stop it, to force flush cycle.\n    const comp = Tracker.nonreactive(() => Tracker.autorun(c => {\n      const data = refs.reactiveFn();\n      if (c.firstRun) {\n        refs.data = data;\n      } else if (!skipUpdate || !skipUpdate(refs.data, data)) {\n        refs.data = data;\n        forceUpdate();\n      }\n    }));\n    // Stop the computation immediately to avoid creating side effects in render.\n    // refers to this issues:\n    // https://github.com/meteor/react-packages/issues/382\n    // https://github.com/meteor/react-packages/issues/381\n    if (refs.comp) refs.comp.stop();\n    // In some cases, the useEffect hook will run before Meteor.defer, such as\n    // when React.lazy is used. This will allow it to be stopped earlier in\n    // useEffect if needed.\n    refs.comp = comp;\n    // To avoid creating side effects in render, stop the computation immediately\n    Meteor.defer(() => {\n      if (!refs.isMounted && refs.comp) {\n        refs.comp.stop();\n        delete refs.comp;\n      }\n    });\n  }, deps);\n  useEffect(() => {\n    // Let subsequent renders know we are mounted (render is committed).\n    refs.isMounted = true;\n    if (!refs.comp) {\n      refs.comp = Tracker.nonreactive(() => Tracker.autorun(c => {\n        const data = refs.reactiveFn(c);\n        if (!skipUpdate || !skipUpdate(refs.data, data)) {\n          refs.data = data;\n          forceUpdate();\n        }\n      }));\n    }\n    return () => {\n      refs.comp.stop();\n      delete refs.comp;\n      refs.isMounted = false;\n    };\n  }, deps);\n  return refs.data;\n};\nfunction useTrackerClient(reactiveFn) {\n  let deps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  let skipUpdate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  if (deps === null || deps === undefined || !Array.isArray(deps)) {\n    if (typeof deps === \"function\") {\n      skipUpdate = deps;\n    }\n    return useTrackerNoDeps(reactiveFn, skipUpdate);\n  } else {\n    return useTrackerWithDeps(reactiveFn, deps, skipUpdate);\n  }\n}\nconst useTrackerServer = reactiveFn => {\n  return Tracker.nonreactive(reactiveFn);\n};\n// When rendering on the server, we don't want to use the Tracker.\n// We only do the first rendering on the server so we can get the data right away\nconst _useTracker = Meteor.isServer ? useTrackerServer : useTrackerClient;\nfunction useTrackerDev(reactiveFn) {\n  let deps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  let skipUpdate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  function warn(expects, pos, arg, type) {\n    console.warn(\"Warning: useTracker expected a \".concat(expects, \" in it's \").concat(pos, \" argument \") + \"(\".concat(arg, \"), but got type of `\").concat(type, \"`.\"));\n  }\n  if (typeof reactiveFn !== 'function') {\n    warn(\"function\", \"1st\", \"reactiveFn\", reactiveFn);\n  }\n  if (deps && skipUpdate && !Array.isArray(deps) && typeof skipUpdate === \"function\") {\n    warn(\"array & function\", \"2nd and 3rd\", \"deps, skipUpdate\", \"\".concat(typeof deps, \" & \").concat(typeof skipUpdate));\n  } else {\n    if (deps && !Array.isArray(deps) && typeof deps !== \"function\") {\n      warn(\"array or function\", \"2nd\", \"deps or skipUpdate\", typeof deps);\n    }\n    if (skipUpdate && typeof skipUpdate !== \"function\") {\n      warn(\"function\", \"3rd\", \"skipUpdate\", typeof skipUpdate);\n    }\n  }\n  const data = _useTracker(reactiveFn, deps, skipUpdate);\n  checkCursor(data);\n  return data;\n}\nconst useTracker = Meteor.isDevelopment ? useTrackerDev : _useTracker;\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"withTracker.tsx\":function module(require,exports,module){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                              //\n// packages/react-meteor-data/withTracker.tsx                                                                   //\n//                                                                                                              //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                //\nlet _extends;\nmodule.link(\"@babel/runtime/helpers/extends\", {\n  default(v) {\n    _extends = v;\n  }\n}, 0);\nmodule.export({\n  withTracker: () => withTracker\n});\nlet React, forwardRef, memo;\nmodule.link(\"react\", {\n  default(v) {\n    React = v;\n  },\n  forwardRef(v) {\n    forwardRef = v;\n  },\n  memo(v) {\n    memo = v;\n  }\n}, 0);\nlet useTracker;\nmodule.link(\"./useTracker\", {\n  useTracker(v) {\n    useTracker = v;\n  }\n}, 1);\nconst withTracker = options => {\n  return Component => {\n    const getMeteorData = typeof options === 'function' ? options : options.getMeteorData;\n    const WithTracker = /*#__PURE__*/forwardRef((props, ref) => {\n      const data = useTracker(() => getMeteorData(props) || {}, options.skipUpdate);\n      return /*#__PURE__*/React.createElement(Component, _extends({\n        ref: ref\n      }, props, data));\n    });\n    const {\n      pure = true\n    } = options;\n    return pure ? /*#__PURE__*/memo(WithTracker) : WithTracker;\n  };\n};\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}}}},{\n  \"extensions\": [\n    \".js\",\n    \".json\",\n    \".ts\",\n    \".tsx\"\n  ]\n});\n\n\n/* Exports */\nPackage._define(\"react-meteor-data\");\n\n})();\n","servePath":"/packages/react-meteor-data.js","sourceMap":{"version":3,"sources":["packages/react-meteor-data/index.js","packages/react-meteor-data/useFind.ts","packages/react-meteor-data/useSubscribe.ts","packages/react-meteor-data/useTracker.ts","packages/react-meteor-data/withTracker.tsx"],"names":["React","module","link","default","v","useTracker","withTracker","useFind","useSubscribe","Meteor","isDevelopment","version","split","console","warn","export","Mongo","useReducer","useMemo","useEffect","useRef","Tracker","useFindReducer","data","action","type","slice","atIndex","document","doc","fromIndex","copy","splice","toIndex","checkCursor","cursor","undefined","Cursor","_mongo","_cursorDescription","fetchData","observer","observe","addedAt","before","stop","useFindClient","factory","deps","nonreactive","dispatch","didMount","current","changedAt","newDocument","oldDocument","removedAt","movedTo","_suppress_initial","useFindServer","fetch","isServer","useFindDev","expects","pos","arg","Array","isArray","exportDefault","useSubscribeClient","name","args","updateOnReady","subscription","isReady","subscribe","ready","useSubscribeServer","shouldWarn","Package","mongo","Object","getPrototypeOf","prototype","keys","forEach","key","fur","x","useForceUpdate","useTrackerNoDeps","reactiveFn","skipUpdate","refs","isMounted","trackerData","forceUpdate","computation","autorun","c","firstRun","defer","useTrackerWithDeps","comp","useTrackerClient","useTrackerServer","_useTracker","useTrackerDev","_extends","forwardRef","memo","options","Component","getMeteorData","WithTracker","props","ref","pure"],"mappings":"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","file":"/packages/react-meteor-data.js","sourcesContent":["/* global Meteor*/\nimport React from 'react';\n\nif (Meteor.isDevelopment) {\n  const v = React.version.split('.');\n  if (v[0] < 16 || (v[0] == 16 && v[1] < 8)) {\n    console.warn('react-meteor-data 2.x requires React version >= 16.8.');\n  }\n}\n\nexport { useTracker } from './useTracker';\nexport { withTracker } from './withTracker.tsx';\nexport { useFind } from './useFind';\nexport { useSubscribe } from './useSubscribe';","import { Meteor } from 'meteor/meteor'\nimport { Mongo } from 'meteor/mongo'\nimport { useReducer, useMemo, useEffect, Reducer, DependencyList, useRef } from 'react'\nimport { Tracker } from 'meteor/tracker'\n\ntype useFindActions<T> =\n  | { type: 'refresh', data: T[] }\n  | { type: 'addedAt', document: T, atIndex: number }\n  | { type: 'changedAt', document: T, atIndex: number }\n  | { type: 'removedAt', atIndex: number }\n  | { type: 'movedTo', fromIndex: number, toIndex: number }\n\nconst useFindReducer = <T>(data: T[], action: useFindActions<T>): T[] => {\n  switch (action.type) {\n    case 'refresh':\n      return action.data\n    case 'addedAt':\n      return [\n        ...data.slice(0, action.atIndex),\n        action.document,\n        ...data.slice(action.atIndex)\n      ]\n    case 'changedAt':\n      return [\n        ...data.slice(0, action.atIndex),\n        action.document,\n        ...data.slice(action.atIndex + 1)\n      ]\n    case 'removedAt':\n      return [\n        ...data.slice(0, action.atIndex),\n        ...data.slice(action.atIndex + 1)\n      ]\n    case 'movedTo':\n      const doc = data[action.fromIndex]\n      const copy = [\n        ...data.slice(0, action.fromIndex),\n        ...data.slice(action.fromIndex + 1)\n      ]\n      copy.splice(action.toIndex, 0, doc)\n      return copy\n  }\n}\n\n// Check for valid Cursor or null.\n// On client, we should have a Mongo.Cursor (defined in\n// https://github.com/meteor/meteor/blob/devel/packages/minimongo/cursor.js and\n// https://github.com/meteor/meteor/blob/devel/packages/mongo/collection.js).\n// On server, however, we instead get a private Cursor type from\n// https://github.com/meteor/meteor/blob/devel/packages/mongo/mongo_driver.js\n// which has fields _mongo and _cursorDescription.\nconst checkCursor = <T>(cursor: Mongo.Cursor<T> | Partial<{ _mongo: any, _cursorDescription: any }> | undefined | null) => {\n  if (cursor !== null && cursor !== undefined && !(cursor instanceof Mongo.Cursor) &&\n      !(cursor._mongo && cursor._cursorDescription)) {\n    console.warn(\n      'Warning: useFind requires an instance of Mongo.Cursor. '\n      + 'Make sure you do NOT call .fetch() on your cursor.'\n    );\n  }\n}\n\n// Synchronous data fetch. It uses cursor observing instead of cursor.fetch() because synchronous fetch will be deprecated.\nconst fetchData = <T>(cursor: Mongo.Cursor<T>) => {\n  const data: T[] = []\n  const observer = cursor.observe({\n    addedAt (document, atIndex, before) {\n      data.splice(atIndex, 0, document)\n    },\n  })\n  observer.stop()\n  return data\n}\n\nconst useFindClient = <T = any>(factory: () => (Mongo.Cursor<T> | undefined | null), deps: DependencyList = []) => {\n  const cursor = useMemo(() => {\n    // To avoid creating side effects in render, opt out\n    // of Tracker integration altogether.\n    const cursor = Tracker.nonreactive(factory);\n    if (Meteor.isDevelopment) {\n      checkCursor(cursor)\n    }\n    return cursor\n  }, deps)\n\n  const [data, dispatch] = useReducer<Reducer<T[], useFindActions<T>>, null>(\n    useFindReducer,\n    null,\n    () => {\n      if (!(cursor instanceof Mongo.Cursor)) {\n        return []\n      }\n\n      return fetchData(cursor)\n    }\n  )\n\n  // Store information about mounting the component.\n  // It will be used to run code only if the component is updated.\n  const didMount = useRef(false)\n\n  useEffect(() => {\n    // Fetch intitial data if cursor was changed.\n    if (didMount.current) {\n      if (!(cursor instanceof Mongo.Cursor)) {\n        return\n      }\n\n      const data = fetchData(cursor)\n      dispatch({ type: 'refresh', data })\n    } else {\n      didMount.current = true\n    }\n\n    if (!(cursor instanceof Mongo.Cursor)) {\n      return\n    }\n\n    const observer = cursor.observe({\n      addedAt (document, atIndex, before) {\n        dispatch({ type: 'addedAt', document, atIndex })\n      },\n      changedAt (newDocument, oldDocument, atIndex) {\n        dispatch({ type: 'changedAt', document: newDocument, atIndex })\n      },\n      removedAt (oldDocument, atIndex) {\n        dispatch({ type: 'removedAt', atIndex })\n      },\n      movedTo (document, fromIndex, toIndex, before) {\n        dispatch({ type: 'movedTo', fromIndex, toIndex })\n      },\n      // @ts-ignore\n      _suppress_initial: true\n    })\n\n    return () => {\n      observer.stop()\n    }\n  }, [cursor])\n\n  return cursor ? data : cursor\n}\n\nconst useFindServer = <T = any>(factory: () => Mongo.Cursor<T> | undefined | null, deps: DependencyList) => (\n  Tracker.nonreactive(() => {\n    const cursor = factory()\n    if (Meteor.isDevelopment) checkCursor(cursor)\n    return cursor?.fetch?.() ?? null\n  })\n)\n\nexport const useFind = Meteor.isServer\n  ? useFindServer\n  : useFindClient\n\nfunction useFindDev <T = any>(factory: () => (Mongo.Cursor<T> | undefined | null), deps: DependencyList = []) {\n  function warn (expects: string, pos: string, arg: string, type: string) {\n    console.warn(\n      `Warning: useFind expected a ${expects} in it\\'s ${pos} argument `\n        + `(${arg}), but got type of \\`${type}\\`.`\n    );\n  }\n\n  if (typeof factory !== 'function') {\n    warn(\"function\", \"1st\", \"reactiveFn\", factory);\n  }\n\n  if (!deps || !Array.isArray(deps)) {\n    warn(\"array\", \"2nd\", \"deps\", typeof deps);\n  }\n\n  return useFind(factory, deps);\n}\n\nexport default Meteor.isDevelopment\n  ? useFindDev\n  : useFind;\n","import { Meteor } from 'meteor/meteor'\nimport { useTracker } from './useTracker'\n\nconst useSubscribeClient = (name?: string, ...args: any[]): () => boolean => {\n  let updateOnReady = false\n  let subscription: Meteor.SubscriptionHandle\n\n  const isReady = useTracker(() => {\n    if (!name) return true\n\n    subscription = Meteor.subscribe(name, ...args)\n\n    return subscription.ready()\n  }, () => (!updateOnReady))\n\n  return () => {\n    updateOnReady = true\n    return !isReady\n  }\n}\n\nconst useSubscribeServer = (name?: string, ...args: any[]): () => boolean => (\n  () => false\n)\n\nexport const useSubscribe = Meteor.isServer\n  ? useSubscribeServer\n  : useSubscribeClient\n","declare var Package: any\nimport { Meteor } from 'meteor/meteor';\nimport { Tracker } from 'meteor/tracker';\nimport { useReducer, useEffect, useRef, useMemo, DependencyList } from 'react';\n\n// Warns if data is a Mongo.Cursor or a POJO containing a Mongo.Cursor.\nfunction checkCursor (data: any): void {\n  let shouldWarn = false;\n  if (Package.mongo && Package.mongo.Mongo && data && typeof data === 'object') {\n    if (data instanceof Package.mongo.Mongo.Cursor) {\n      shouldWarn = true;\n    } else if (Object.getPrototypeOf(data) === Object.prototype) {\n      Object.keys(data).forEach((key) => {\n        if (data[key] instanceof Package.mongo.Mongo.Cursor) {\n          shouldWarn = true;\n        }\n      });\n    }\n  }\n  if (shouldWarn) {\n    console.warn(\n      'Warning: your reactive function is returning a Mongo cursor. '\n      + 'This value will not be reactive. You probably want to call '\n      + '`.fetch()` on the cursor before returning it.'\n    );\n  }\n}\n\n// Used to create a forceUpdate from useReducer. Forces update by\n// incrementing a number whenever the dispatch method is invoked.\nconst fur = (x: number): number => x + 1;\nconst useForceUpdate = () => useReducer(fur, 0)[1];\n\nexport interface IReactiveFn<T> {\n  (c?: Tracker.Computation): T\n}\n\nexport interface ISkipUpdate<T> {\n  <T>(prev: T, next: T): boolean\n}\n\ntype TrackerRefs = {\n  computation?: Tracker.Computation;\n  isMounted: boolean;\n  trackerData: any;\n}\n\nconst useTrackerNoDeps = <T = any>(reactiveFn: IReactiveFn<T>, skipUpdate: ISkipUpdate<T> = null) => {\n  const { current: refs } = useRef<TrackerRefs>({\n    isMounted: false,\n    trackerData: null\n  });\n  const forceUpdate = useForceUpdate();\n\n  // Without deps, always dispose and recreate the computation with every render.\n  if (refs.computation) {\n    refs.computation.stop();\n    // @ts-ignore This makes TS think ref.computation is \"never\" set\n    delete refs.computation;\n  }\n\n  // Use Tracker.nonreactive in case we are inside a Tracker Computation.\n  // This can happen if someone calls `ReactDOM.render` inside a Computation.\n  // In that case, we want to opt out of the normal behavior of nested\n  // Computations, where if the outer one is invalidated or stopped,\n  // it stops the inner one.\n  Tracker.nonreactive(() => Tracker.autorun((c: Tracker.Computation) => {\n    refs.computation = c;\n    const data = reactiveFn(c);\n    if (c.firstRun) {\n      // Always run the reactiveFn on firstRun\n      refs.trackerData = data;\n    } else if (!skipUpdate || !skipUpdate(refs.trackerData, data)) {\n      // For any reactive change, forceUpdate and let the next render rebuild the computation.\n      forceUpdate();\n    }\n  }));\n\n  // To clean up side effects in render, stop the computation immediately\n  if (!refs.isMounted) {\n    Meteor.defer(() => {\n      if (!refs.isMounted && refs.computation) {\n        refs.computation.stop();\n        delete refs.computation;\n      }\n    });\n  }\n\n  useEffect(() => {\n    // Let subsequent renders know we are mounted (render is committed).\n    refs.isMounted = true;\n\n    // In some cases, the useEffect hook will run before Meteor.defer, such as\n    // when React.lazy is used. In those cases, we might as well leave the\n    // computation alone!\n    if (!refs.computation) {\n      // Render is committed, but we no longer have a computation. Invoke\n      // forceUpdate and let the next render recreate the computation.\n      if (!skipUpdate) {\n        forceUpdate();\n      } else {\n        Tracker.nonreactive(() => Tracker.autorun((c: Tracker.Computation) => {\n          const data = reactiveFn(c);\n          refs.computation = c;\n          if (!skipUpdate(refs.trackerData, data)) {\n            // For any reactive change, forceUpdate and let the next render rebuild the computation.\n            forceUpdate();\n          }\n        }));\n      }\n    }\n\n    // stop the computation on unmount\n    return () =>{\n      refs.computation?.stop();\n      delete refs.computation;\n      refs.isMounted = false;\n    }\n  }, []);\n\n  return refs.trackerData;\n}\n\nconst useTrackerWithDeps = <T = any>(reactiveFn: IReactiveFn<T>, deps: DependencyList, skipUpdate: ISkipUpdate<T> = null): T => {\n  const forceUpdate = useForceUpdate();\n\n  const { current: refs } = useRef<{\n    reactiveFn: IReactiveFn<T>;\n    data?: T;\n    comp?: Tracker.Computation;\n    isMounted?: boolean;\n  }>({ reactiveFn });\n\n  // keep reactiveFn ref fresh\n  refs.reactiveFn = reactiveFn;\n\n  useMemo(() => {\n    // To jive with the lifecycle interplay between Tracker/Subscribe, run the\n    // reactive function in a computation, then stop it, to force flush cycle.\n    const comp = Tracker.nonreactive(\n      () => Tracker.autorun((c: Tracker.Computation) => {\n        const data = refs.reactiveFn();\n        if (c.firstRun) {\n          refs.data = data;\n        } else if (!skipUpdate || !skipUpdate(refs.data, data)) {\n          refs.data = data;\n          forceUpdate();\n        }\n      })\n    );\n\n    // Stop the computation immediately to avoid creating side effects in render.\n    // refers to this issues:\n    // https://github.com/meteor/react-packages/issues/382\n    // https://github.com/meteor/react-packages/issues/381\n    if (refs.comp) refs.comp.stop();\n\n    // In some cases, the useEffect hook will run before Meteor.defer, such as\n    // when React.lazy is used. This will allow it to be stopped earlier in\n    // useEffect if needed.\n    refs.comp = comp;\n    // To avoid creating side effects in render, stop the computation immediately\n    Meteor.defer(() => {\n      if (!refs.isMounted && refs.comp) {\n        refs.comp.stop();\n        delete refs.comp;\n      }\n    });\n  }, deps);\n\n  useEffect(() => {\n    // Let subsequent renders know we are mounted (render is committed).\n    refs.isMounted = true;\n\n    if (!refs.comp) {\n      refs.comp = Tracker.nonreactive(\n        () => Tracker.autorun((c) => {\n          const data: T = refs.reactiveFn(c);\n          if (!skipUpdate || !skipUpdate(refs.data, data)) {\n            refs.data = data;\n            forceUpdate();\n          }\n        })\n      );\n    }\n\n    return () => {\n      refs.comp.stop();\n      delete refs.comp;\n      refs.isMounted = false;\n    };\n  }, deps);\n\n  return refs.data as T;\n};\n\nfunction useTrackerClient <T = any>(reactiveFn: IReactiveFn<T>, skipUpdate?: ISkipUpdate<T>): T;\nfunction useTrackerClient <T = any>(reactiveFn: IReactiveFn<T>, deps?: DependencyList, skipUpdate?: ISkipUpdate<T>): T;\nfunction useTrackerClient <T = any>(reactiveFn: IReactiveFn<T>, deps: DependencyList | ISkipUpdate<T> = null, skipUpdate: ISkipUpdate<T> = null): T {\n  if (deps === null || deps === undefined || !Array.isArray(deps)) {\n    if (typeof deps === \"function\") {\n      skipUpdate = deps;\n    }\n    return useTrackerNoDeps(reactiveFn, skipUpdate);\n  } else {\n    return useTrackerWithDeps(reactiveFn, deps, skipUpdate);\n  }\n}\n\nconst useTrackerServer: typeof useTrackerClient = (reactiveFn) => {\n  return Tracker.nonreactive(reactiveFn);\n}\n\n// When rendering on the server, we don't want to use the Tracker.\n// We only do the first rendering on the server so we can get the data right away\nconst _useTracker = Meteor.isServer\n  ? useTrackerServer\n  : useTrackerClient;\n\nfunction useTrackerDev (reactiveFn, deps = null, skipUpdate = null) {\n  function warn (expects: string, pos: string, arg: string, type: string) {\n    console.warn(\n      `Warning: useTracker expected a ${expects} in it\\'s ${pos} argument `\n        + `(${arg}), but got type of \\`${type}\\`.`\n    );\n  }\n\n  if (typeof reactiveFn !== 'function') {\n    warn(\"function\", \"1st\", \"reactiveFn\", reactiveFn);\n  }\n\n  if (deps && skipUpdate && !Array.isArray(deps) && typeof skipUpdate === \"function\") {\n    warn(\"array & function\", \"2nd and 3rd\", \"deps, skipUpdate\",\n      `${typeof deps} & ${typeof skipUpdate}`);\n  } else {\n    if (deps && !Array.isArray(deps) && typeof deps !== \"function\") {\n      warn(\"array or function\", \"2nd\", \"deps or skipUpdate\", typeof deps);\n    }\n    if (skipUpdate && typeof skipUpdate !== \"function\") {\n      warn(\"function\", \"3rd\", \"skipUpdate\", typeof skipUpdate);\n    }\n  }\n\n  const data = _useTracker(reactiveFn, deps, skipUpdate);\n  checkCursor(data);\n  return data;\n}\n\nexport const useTracker = Meteor.isDevelopment\n  ? useTrackerDev as typeof useTrackerClient\n  : _useTracker;\n","import React, { forwardRef, memo } from 'react';\nimport { useTracker } from './useTracker';\n\ntype ReactiveFn = (props: object) => any;\ntype ReactiveOptions = {\n  getMeteorData: ReactiveFn;\n  pure?: boolean;\n  skipUpdate?: (prev: any, next: any) => boolean;\n}\n\nexport const withTracker = (options: ReactiveFn | ReactiveOptions) => {\n  return (Component: React.ComponentType) => {\n    const getMeteorData = typeof options === 'function'\n      ? options\n      : options.getMeteorData;\n\n    const WithTracker = forwardRef((props, ref) => {\n      const data = useTracker(\n        () => getMeteorData(props) || {},\n        (options as ReactiveOptions).skipUpdate\n      );\n      return (\n        <Component ref={ref} {...props} {...data} />\n      );\n    });\n\n    const { pure = true } = options as ReactiveOptions;\n    return pure ? memo(WithTracker) : WithTracker;\n  };\n}\n"]}}]